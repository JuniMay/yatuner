# proj105-yaTuner: 编译器自动调优

## 设计目标

针对多目标（代码大小、运行速度等）实现对 GCC 优化选项的自动调参。

## 前期调研

经过前期调研和实验分析，程序的运行时间往往既有随机性，已有的自动调优方案往往仅进行一次采样，没有对运行时间的不确定性进行考虑，容易受系统波动影响，造成统计误差。

对此我们通过测试，采用perf工具对cpu时钟周期进行计数，提高了采样的稳定性，同时验证了程序运行时间近似正态分布，并依此开创性地使用假设检验方法判定优化选项对运行时间的影响显著性，减小了统计误差。

针对 GCC 编译和程序运行参数离散，目标函数导数未知等特征，调研超参数优化问题的常见解决方法，选择使用启发式搜索算法对参数进行搜索，实现了基于高斯过程的贝叶斯优化和context-based LinUCB优化方法。实现了利用程序 Profiling 信息对下一步优化的反馈。

## 当前开发状况

- [x] GCC 调用封装
- [x] 对代码大小优化：能够得到相比 `-Os` 较小的程序
- [x] 对运行速度优化：目前在某些程序上能够得到比 `-O3` 或 `-O2` 更好的效果
- [x] 贝叶斯优化方法
- [x] LinUCB优化方法
- [ ] openEular环境适配
- [x] 优化目标配置文件
- [ ] 对内存占用优化
- [x] 测试其他优化方式（遗传算法等）
- [x] 对编译错误和警告的处理
- [x] Topdown 分析
- [x] Profiling-based 优化
- [x] 针对带参数的编译选项的优化
- [x] 生成优化结果图表
- [x] 自动生成配置脚本
- [x] 

## 沟通情况

已与导师建立有效的沟通渠道。

## 当前困难

- 无可用的OpenEular服务器环境，无法进行环境适配和优化wrf 

## 调优示例

见 `examples/` 文件夹

## FAQ

1. 为什么使用脚本文件进行优化项目的配置

yatuner 的目的并不是完成项目的构建，而是对已有构建配置的项目进行调优，直接使用 python 进行项目调优的配置可以使得调优和编译过程的自由度更高。